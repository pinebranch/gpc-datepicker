(function(v,D){typeof exports=="object"&&typeof module!="undefined"?module.exports=D():typeof define=="function"&&define.amd?define(D):(v=typeof globalThis!="undefined"?globalThis:v||self,v.DatePicker=D())})(this,function(){"use strict";var v="";const D=/(\[[^[]*\])|([-:/.()\s]+)|(YYYY|YY?|MM?M?M?|DD?|HH?|mm?)/g,m=/\d\d?/,Y=/\d{4}/,S="DD/MM/YYYY",L=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|H{1,2}|m{1,2}/g,p=function(a){return function(e){e=Math.abs(e),this[a]=e}},x={D:[m,p("day")],DD:[m,p("day")],M:[m,p("month")],MM:[m,p("month")],YYYY:[Y,p("year")],H:[m,p("hours")],h:[m,p("hours")],HH:[m,p("hours")],hh:[m,p("hours")],m:[m,p("minutes")],mm:[m,p("minutes")]},k=(a,e,t)=>{const i=String(a);return!i||i.length>=e?a:`${Array(e+1-i.length).join(t)}${a}`};function H(a){const e=a.match(D),{length:t}=e;for(let i=0;i<t;i+=1){const s=e[i],n=x[s],c=n&&n[0],l=n&&n[1];l?e[i]={regex:c,parser:l}:e[i]=s.replace(/^\[|\]$/g,"")}return function(i){const s={};for(let n=0,c=0;n<t;n+=1){const l=e[n];if(typeof l=="string")c+=l.length;else{const{regex:r,parser:f}=l,o=i.substr(c),u=r.exec(o)[0];f.call(s,u),i=i.replace(u,"")}}return s}}function w(a,e){if(a instanceof Date)return a;try{const t=H(e),{year:i,month:s,day:n,hours:c,minutes:l}=t(a),r=new Date,f=n||(!i&&!s?r.getDate():1),o=i||r.getFullYear(),d=c||0,u=l||0;let y=0;return i&&!s||(y=s>0?s-1:r.getMonth()),new Date(o,y,f,d,u)}catch{return new Date("")}}function M(a,e){let t=a.getFullYear(),i=a.getMonth(),s=a.getDate(),n=a.getHours(),c=a.getMinutes();const l=e||S,r={YY:String(t).slice(-2),YYYY:t,M:i+1,MM:k(i+1,2,"0"),D:s,DD:k(s,2,"0"),H:String(n),HH:k(n,2,"0"),m:String(c),mm:k(c,2,"0")};return l.replace(L,(f,o)=>o||r[f])}function g(a){return a instanceof Date&&!isNaN(a)}function b(a,e){return a.getFullYear()===e.getFullYear()&&a.getDate()===e.getDate()&&a.getMonth()===e.getMonth()}const C={vi:{days:["Ch\u1EE7 nh\u1EADt","Th\u1EE9 hai","Th\u1EE9 ba","Th\u1EE9 t\u01B0","Th\u1EE9 n\u0103m","Th\u1EE9 s\xE1u","Th\u1EE9 b\u1EA3y"],daysShort:["CN","Th\u1EE9 2","Th\u1EE9 3","Th\u1EE9 4","Th\u1EE9 5","Th\u1EE9 6","Th\u1EE9 7"],daysMin:["CN","T2","T3","T4","T5","T6","T7"],months:["Th\xE1ng 1","Th\xE1ng 2","Th\xE1ng 3","Th\xE1ng 4","Th\xE1ng 5","Th\xE1ng 6","Th\xE1ng 7","Th\xE1ng 8","Th\xE1ng 9","Th\xE1ng 10","Th\xE1ng 11","Th\xE1ng 12"],monthsShort:["Th1","Th2","Th3","Th4","Th5","Th6","Th7","Th8","Th9","Th10","Th11","Th12"],today:"H\xF4m nay",clear:"X\xF3a",close:"\u0110\xF3ng",ok:"OK",format:"DD/MM/YYYY"},en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",close:"Close",ok:"OK",format:"DD/MM/YYYY"}};function h(a,e,t=""){const i=document.createElement(a);i.innerHTML=t;for(const s in e)i.setAttribute(s,e[s]);return i}let E=`
    <div class="gpc-cal-header">
        <button class="btn-prev"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/></svg></button>
        <span class="gpc-cal-caption"></span>
        <button class="btn-next"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button>
    </div>
    <div class="gpc-cal-meta"></div>
    <div class="gpc-cal-body"></div>
    <div class="gpc-cal-footer"></div>
`;class T{constructor(e,t){this.picker=e,this.viewDate=new Date(+t),this.container=this.initView(),this.picker.calendar.appendChild(this.container),this.elements=Object.assign({},this.getViewElements()),this.displayState=!1}initView(){return h("div",{class:"gpc-cal-view"},E)}getViewElements(){let e=this,t=this.container.querySelector(".btn-prev"),i=this.container.querySelector(".btn-next"),s=this.container.querySelector(".gpc-cal-caption"),n=this.container.querySelector(".gpc-cal-meta"),c=this.container.querySelector(".gpc-cal-body"),l=this.container.querySelector(".gpc-cal-footer"),r=new Date;return n.classList.add("gpc-cal-meta-today"),n.innerHTML=this.picker.locale.today+" "+M(r,this.picker.options.format),n.addEventListener("click",function(){e.picker.setDate(r),e.viewDate=new Date(+r),e.render()}),t.addEventListener("click",function(){e.btnNavEvent("prev")}),i.addEventListener("click",function(){e.btnNavEvent("next")}),{btnPrev:t,btnNext:i,caption:s,meta:n,body:c,footer:l}}show(e,t){this.displayState=e,this.viewDate=new Date(+t),e?(this.container.classList.add("active"),this.render()):this.container.classList.remove("active")}btnNavEvent(e){let t=e==="prev"?this.navStep*-1:this.navStep;this.type==="days"?this.viewDate.setMonth(this.viewDate.getMonth()+t):this.viewDate.setFullYear(this.viewDate.getFullYear()+t),this.render()}render(){}}class F extends T{constructor(e,t){super(e,t);this.type="days",this.navStep=1,this.initViewElements()}initViewElements(){let e=this;this.container.id=this.picker.host.getAttribute("id")+"-days",this.container.classList.add("view-days"),this.elements.captionMonth=h("span",{class:"gpc-cal-caption-month gpc-cal-caption-button"}),this.elements.captionMonth.addEventListener("click",function(){e.picker.changeView("months",e.viewDate)}),this.elements.captionYear=h("span",{class:"gpc-cal-caption-year gpc-cal-caption-button"}),this.elements.captionYear.addEventListener("click",function(){e.picker.changeView("years",e.viewDate)}),this.elements.caption.appendChild(this.elements.captionMonth),this.elements.caption.appendChild(this.elements.captionYear)}render(){let e=this,t=this.picker.locale.months,i=new Date,s=this.viewDate.getMonth(),n=this.viewDate.getFullYear();this.elements.captionMonth.innerText=t[s],this.elements.captionYear.innerText=n.toString();let c=new Date(n,s+1,0).getDate(),l=new Date(n,s,1).getDay(),r=[];for(let o=0;o<l;o++)r.push(0);for(let o=1;o<=c;o++)r.push(o);this.elements.body.innerHTML="",this.elements.body.appendChild(this.renderDaysName());let f=h("div",{class:"gpc-cal-days-list"});for(let o of r){let d=document.createElement("span");if(o==0)d.classList.add("gpc-cal-day-past");else{let u=new Date(n,s,o);d.classList.add("gpc-cal-day","gpc-cal-day-"+u.getDay()),b(i,u)&&d.classList.add("gpc-cal-today"),g(this.picker.selectedDate)&&b(this.picker.selectedDate,u)&&d.classList.add("selected"),d.innerText=`${o}`,this.isDateDisabled(u)?d.classList.add("disabled"):d.onclick=function(){e.picker.hasTimePicker&&e.setSelectedTime(u),e.picker.setDate(u);let y=e.elements.body.querySelector(".selected");y&&y.classList.remove("selected"),d.classList.add("selected"),e.picker.hasTimePicker||e.picker.hide()}}f.appendChild(d)}this.elements.body.appendChild(f),this.picker.hasTimePicker&&this.renderTimePicker()}renderDaysName(){let e=this.picker.locale.daysMin,t=h("div",{class:"gpc-cal-days-name"});for(let i=0;i<=6;i++){let s=h("div",{class:"gpc-cal-day-"+i},e[i]);t.appendChild(s)}return t}renderTimePicker(){let e=this,t=this.picker.options.timepicker;if(!this.picker.hasTimePicker)return;this.elements.footer.innerHTML="";let i=h("div",{class:"gpc-cal-timepicker"}),s=h("select",{class:"gpc-cal-select gpc-cal-hours"});for(let l=t.minHour;l<=t.maxHour;l++){let r=h("option",{value:l},l.toString().padStart(2,"0"));this.picker.selectedDate.getHours()===l&&(r.selected=!0),s.appendChild(r)}let n=h("select",{class:"gpc-cal-select gpc-cal-minutes"});for(let l=0;l<60;l+=t.minuteStep){let r=h("option",{value:l},l.toString().padStart(2,"0"));this.picker.selectedDate.getMinutes()===l&&(r.selected=!0),n.appendChild(r)}let c=h("button",{class:"gpc-cal-btn gpc-cal-btn-ok"},this.picker.locale.ok);c.addEventListener("click",function(){let l=e.picker.selectedDate;e.setSelectedTime(l),e.picker.setDate(l),e.picker.hide()}),i.appendChild(s),i.appendChild(n),i.appendChild(c),this.elements.footer.appendChild(i)}setSelectedTime(e){let t=this.elements.footer.querySelector(".gpc-cal-hours"),i=this.elements.footer.querySelector(".gpc-cal-minutes"),s=t.value,n=i.value;e.setHours(s),e.setMinutes(n)}isDateDisabled(e){return!!(g(this.picker.options.minDate)&&this.picker.options.minDate>e||g(this.picker.options.maxDate)&&this.picker.options.maxDate<e)}}class V extends T{constructor(e,t){super(e,t);this.type="months",this.navStep=1,this.initViewElements()}initViewElements(){this.container.id=this.picker.host.getAttribute("id")+"-months",this.container.classList.add("view-months"),this.elements.caption.innerHTML=this.picker.selectedDate.getFullYear()}render(){let e=this,t=this.viewDate.getFullYear();this.elements.caption.innerHTML=t;let i=this.picker.locale.months;this.elements.body.innerHTML="";for(let s=0;s<12;s++){let n=h("span",{class:"gpc-cal-month"},i[s]);s===this.picker.selectedDate.getMonth()&&this.picker.selectedDate.getFullYear()===t&&n.classList.add("selected"),this.isMonthDisabled(s,t)?n.classList.add("disabled"):n.addEventListener("click",function(){e.viewDate.setMonth(s),e.picker.changeView("days",e.viewDate)}),this.elements.body.appendChild(n)}}isMonthDisabled(e,t){let i=this.picker.options.minDate,s=this.picker.options.maxDate;return!!(g(i)&&(i.getMonth()>e&&i.getFullYear()==t||i.getFullYear()>t)||g(this.picker.options.maxDate)&&(s.getMonth()<e&&s.getFullYear()==t||s.getFullYear()<t))}}class P extends T{constructor(e,t){super(e,t);this.type="years",this.navStep=10,this.initViewElements()}initViewElements(){this.container.id=this.picker.host.getAttribute("id")+"-years",this.container.classList.add("view-years");let e=this.getYearsRange(this.picker.selectedDate);this.elements.caption.innerHTML=`${e.start} - ${e.end}`}render(){let e=this,t=this.getYearsRange(this.viewDate);this.elements.caption.innerHTML=`${t.start} - ${t.end}`,this.elements.body.innerHTML="";for(let i=t.start-1;i<=t.end;i++){let s=h("span",{class:"gpc-cal-year"},i.toString());i===this.picker.selectedDate.getFullYear()&&s.classList.add("selected"),this.isYearDisabled(i)?s.classList.add("disabled"):s.addEventListener("click",function(){e.viewDate.setFullYear(i),e.picker.changeView("days",e.viewDate)}),this.elements.body.appendChild(s)}}getYearsRange(e){let t=Math.floor(e.getFullYear()/10)*10,i=t+10;return{start:t,end:i}}isYearDisabled(e){let t=this.picker.options.minDate,i=this.picker.options.maxDate;return!!(g(t)&&t.getFullYear()>e||g(this.picker.options.maxDate)&&i.getFullYear()<e)}}function A(){return(performance.now().toString(36)+Math.random().toString(36)).replace(/\./g,"")}class O{constructor(e,t){this.options={format:"DD/MM/YYYY",initialDate:new Date,minDate:null,maxDate:null,locale:"vi",timepicker:null},this.isCalendarVisible=!1,this.defaultTimePickerOptions={minHour:0,maxHour:23,minuteStep:5},this.host=e,this.options=Object.assign(this.options,t),this.locale=C[this.options.locale],this.options.timepicker!=null&&this.options.timepicker?(typeof this.options.timepicker!="object"&&(this.options.timepicker={}),this.options.timepicker=Object.assign(this.defaultTimePickerOptions,this.options.timepicker),this.options.format+=" HH:mm",this.hasTimePicker=!0):this.hasTimePicker=!1,this.options.minDate=w(this.options.minDate,this.options.format),this.options.maxDate=w(this.options.maxDate,this.options.format),this.setHostAttributes(),this.calendar=this.createCalendarElement(),document.body.appendChild(this.calendar),this.selectedDate=this.getInitDateFromInput(),this.viewDate=this.selectedDate,this.views={days:new F(this,this.selectedDate),months:new V(this,this.selectedDate),years:new P(this,this.selectedDate)},this.currentView="days"}setHostAttributes(){let e=this;this.host.setAttribute("autocomplete","off"),this.host.setAttribute("inputmode","none"),this.host.addEventListener("focus",t=>{this.show("days")}),this.host.addEventListener("change",function(t){let i=t.target.value,s=w(i,e.options.format);g(s)&&e.setDate(s)})}getInitDateFromInput(){if(this.host.value!=""){let e=this.host.value;this.options.timepicker&&e.indexOf(":")<0&&(e+=" 00:00");let t=w(e,this.options.format);if(g(t)&&t!=this.options.initialDate)return t}return this.options.initialDate}createCalendarElement(){(!this.host.id||this.host.id=="")&&(this.host.id=A());let e=h("div",{class:"gpc-calendar",id:this.host.id+"-calendar"}),t=this;return this.calendar=e,document.addEventListener("click",i=>{const s=i.composedPath().includes(e);t.isCalendarVisible&&!s&&i.target!=this.host&&t.hide()}),e}hide(){this.isCalendarVisible=!1,this.calendar.classList.remove("show")}show(e){let{height:t,top:i,left:s}=this.host.getBoundingClientRect(),n=this.calendar.getBoundingClientRect(),c=i+scrollY,l=s+scrollX,r=4+t;i+n.height+t>window.innerHeight&&(r=-4-n.height),this.calendar.style.top=c+r+"px",this.calendar.style.left=l+"px",setTimeout(()=>{this.isCalendarVisible=!0,this.calendar.classList.add("show")},200),this.changeView("days",this.selectedDate)}changeView(e,t){this.views[this.currentView].show(!1,t),this.views[e].show(!0,t),this.currentView=e}setDate(e){this.selectedDate=e,this.host.value=M(e,this.options.format)}getDate(){return this.selectedDate}destroy(){this.calendar.remove()}}return O});
